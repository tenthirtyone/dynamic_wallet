'use client'
import { validatePsbt } from './validator/validatePsbt.js';
import 'bitcoinjs-lib';
import '@dynamic-labs/wallet-connector-core';
import 'sats-connect';

const createPsbtOptions = (psbt, request) => {
    var _a;
    const psbtSignOptions = {
        autoFinalized: false,
    };
    if (request.signature) {
        validatePsbt(psbt, request.allowedSighash, request.signature);
        const toSignInputs = [];
        for (const signature of request.signature) {
            if ((_a = signature.signingIndexes) === null || _a === void 0 ? void 0 : _a.length) {
                for (const index of signature.signingIndexes) {
                    toSignInputs.push({
                        address: signature.address,
                        disableAddressValidation: signature.disableAddressValidation,
                        index,
                        sighashTypes: request.allowedSighash,
                    });
                }
            }
        }
        psbtSignOptions.toSignInputs = toSignInputs;
    }
    return psbtSignOptions;
};

export { createPsbtOptions };
