'use client'
'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var utils = require('@dynamic-labs/utils');
var extractAddressFromInput = require('../extractAddressFromInput.cjs');

const validateAddress = (psbt, signingAddress, index, inputAtIndex) => {
    // we need to extract the address from the input at the current signing index
    // to be able to compare it to the address provided in the request for the current index
    const extractedAddress = extractAddressFromInput.extractAddressFromInput(psbt, index, inputAtIndex);
    if (!extractedAddress)
        throw new utils.DynamicError(`validateAddress - input not found for the given address: ${signingAddress}`);
    if (extractedAddress !== signingAddress)
        throw new utils.DynamicError('validateAddress - address mismatch with index');
};

exports.validateAddress = validateAddress;
