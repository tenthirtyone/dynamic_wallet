'use client'
import { DynamicError } from '@dynamic-labs/utils';
import { extractAddressFromInput } from '../extractAddressFromInput.js';

const validateAddress = (psbt, signingAddress, index, inputAtIndex) => {
    // we need to extract the address from the input at the current signing index
    // to be able to compare it to the address provided in the request for the current index
    const extractedAddress = extractAddressFromInput(psbt, index, inputAtIndex);
    if (!extractedAddress)
        throw new DynamicError(`validateAddress - input not found for the given address: ${signingAddress}`);
    if (extractedAddress !== signingAddress)
        throw new DynamicError('validateAddress - address mismatch with index');
};

export { validateAddress };
